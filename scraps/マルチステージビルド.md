#[[Continuous Delivery]]

[[Dockerfile]]内で複数のビルドステージ（`FROM`命令）を定義し、最終的に必要なアーティファクトのみを抽出して軽量なコンテナイメージを作成する手法

## メリット

- **イメージサイズの大幅削減**: ビルドツールを含まないため、最終イメージサイズを大幅に削減（例: 729MB → 26.2MB）
- **セキュリティ向上**: ビルドツールやソースコードが実行環境に残らない
- **効率的なCI/CDパイプライン**: ビルド環境と実行環境の明確な分離により運用がシンプル化

## 基本的な実装

[[Dockerfile]]内に複数の`FROM`命令を記述し、`COPY --from=<ステージ名>`で前段のステージからアーティファクトをコピー

```dockerfile
# ビルドステージ
FROM golang:1.21 AS builder
WORKDIR /app
COPY . .
RUN go build -o myapp

# 実行ステージ
FROM alpine:latest
COPY --from=builder /app/myapp /myapp
CMD ["/myapp"]
```

<https://docs.docker.jp/develop/develop-images/multistage-build.html>
